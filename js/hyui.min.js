$(function(){document.documentElement.addEventListener("gesturestart",function(e){e.preventDefault()},!1);var e=$(window),i=e.outerWidth(),t=(e.height(),$("body")),n=768;$("html").removeClass("no-js"),$(".navigation ul").length>1&&$(".navigation ul:nth-child(1)").addClass("left_nav"),$(".navigation").has(".language").addClass("have_language");var a=$(".menu");a.find("li").has("ul").addClass("hasChild");var l=a.find("li.hasChild"),s=$(".menu ul").children("li.hasChild");liHasChild_level2=$(".menu ul ul").children("li.hasChild"),liHasChild_level3=$(".menu ul ul ul").children("li.hasChild"),subMenuWidth=l.first().children("ul").outerWidth(),t.prepend('<aside class="sidebar"><div class="m_area"><button type="button" class="sidebarClose">關閉</button></div><div class="menu_overlay"></div></aside>'),$("header .container").prepend('<button type="button" class="sidebarCtrl">側欄選單</button><button type="button" class="searchCtrl">查詢</button>');var o=$(".sidebar"),c=$(".search"),r=$(".navigation"),h=$(".sidebarClose"),d=$(".sidebarCtrl"),u=$(".menu_overlay");_mArea=$(".m_area"),d.append("<span></span><span></span><span></span>");var f,g=!1;function m(){_mArea.animate({"margin-left":-1*_mArea.width()+"px"},500,"easeOutQuint",function(){o.fadeOut(200),_mArea.hide()}),t.removeClass("noscroll"),u.fadeOut(),l.children("ul").hide()}function p(){(i=e.outerWidth())<n?(!1,o.hide(),u.hide(),r.prependTo(_mArea),a.prependTo(_mArea),c.prependTo(t),c.addClass("m_search"),_mArea.css({"margin-left":-1*_mArea.width()+"px"}),s.on({mouseenter:function(){$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")},mouseleave:function(){$(this).parent().siblings("ul").hide(),$(this).children("ul").stop(!0,!0).slideUp("600","easeOutQuint")}}),l.off().on("mouseenter,mouseleave"),l.on("touchstart",function(){$(this).off("mouseenter,mouseleave")}),s.off().on("click",function(e){$(this).siblings("li").find("ul").stop(!0,!0).slideUp("600","easeOutQuint"),$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")}),liHasChild_level2.off().on("click",function(e){$(this).siblings("li").children("ul").stop(!0,!0).slideUp("600","easeOutQuint"),$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")}),liHasChild_level3.off().on("click",function(e){e.preventDefault()}),l.children("a").off().on("click",function(e){e.preventDefault()}),t.off("touchmove"),$(".m_search").hide(),$(".language").find("ul").hide()):(m(),t.removeClass("noscroll"),r.prependTo(".header .container"),c.appendTo(".header .container"),a.appendTo(".header .container"),c.removeClass("m_search"),c.show(),g=!1,$(".language").find("ul").hide(),l.on({mouseenter:function(){$(this).children("ul").stop(!0,!1).fadeIn()},mouseleave:function(){$(this).parent().siblings("ul").hide(),$(this).children("ul").stop(!0,!1).fadeOut()}}),l.off("click"),$(document).on("touchend click",function(e){var i=e.target;$(i).is(".menu li a")||$(".menu").find("li ul").hide()}))}d.click(function(e){o.show(),_mArea.show(),_mArea.animate({"margin-left":0},400,"easeOutQuint"),t.addClass("noscroll"),u.fadeIn(),$(".m_search").hide(),g=!1,e.preventDefault()}),u.add(h).off().click(function(){m()}),u.off("mouseenter"),l.keyup(function(){$(this).children("ul").fadeIn(),$(this).siblings().focus(function(){$(this).hide()})}),a.find("li").keyup(function(){$(this).siblings().children("ul").hide()}),a.find("li:last>a").focusout(function(){a.find("li ul").hide()}),e.bind("load resize",function(e){(g=!1)||(clearTimeout(f),f=setTimeout(function(){g=!1,p()},50))}),p();var v=$(".searchCtrl");$(".m_search").hide(),v.off().on("click",function(e){g?($(".m_search").hide(),g=!1):($(".m_search").stop(!0,!1).slideDown("400","easeOutQuint"),$(".m_search").find('input[type="text"]').focus(),g=!0)}),$(".main").off().on("click touchend",function(e){$(".m_search").hide(),g=!1});var b=$(".header").outerHeight(!0),y=a.outerHeight(!0);function C(){$(".imgOuter").each(function(e,i){var t,n=$(this),a=n.width(),l=n.height(),s=a/l,o=n.find("img"),c=$(this).find("img").width(),r=$(this).find("img").height();s>c/r?(t=a/c,o.width(a).height(r*t).css("top",-.5*(r*t-l))):(t=l/r,o.height(l).width(c*t).css("left",-.5*(c*t-a))),$(this).find("img").removeClass("img-responsive")})}function C(){$(".imgOuter").each(function(e,i){var t,n=$(this),a=n.width(),l=n.height(),s=a/l,o=n.find("img"),c=$(this).find("img").width(),r=$(this).find("img").height();s>c/r?(t=a/c,o.width(a).height(r*t).css("top",-.5*(r*t-l))):(t=l/r,o.height(l).width(c*t).css("left",-.5*(c*t-a))),$(this).find("img").removeClass("img-responsive")})}$(window).bind("load scroll resize",function(t){(i=e.outerWidth())>=n&&$(this).scrollTop()>b-y?(b=$(".header").outerHeight(!0),y=a.outerHeight(!0),$(".header").addClass("fixed"),$(".header").css("margin-top",y-b),$(".main").css("margin-top",b)):($(".header").removeClass("fixed"),$(".header").css("margin-top",0),$(".main").css("margin-top",0))}),$('[class*="notice"] a.close').click(function(e){$(this).parent('[class*="notice"]').hide(),e.preventDefault()}),$(".accordion").each(function(){$(this).find(".accordion-content").hide(),$(this).children("ul").children("li").children("a").each(function(){function e(e){$(this).parent("li").siblings().children("a").removeClass("active"),$(this).toggleClass("active"),$(this).parent("li").siblings().children(".accordion-content").slideUp(),$(this).next(".accordion-content").slideToggle(),e.preventDefault()}$(this).click(e),$(this).keyup(e)})}),$(".btn-fatfooter").click(function(e){$(this).parent(".container").find("nav>ul>li>ul").stop(!0,!0).slideToggle(function(){$(this).is(":visible")?($(".btn-fatfooter").html("收合/CLOSE"),$(".btn-fatfooter").attr("name","收合選單/CLOSE")):($(".btn-fatfooter").html("展開/OPEN"),$(".btn-fatfooter").attr("name","展開選單/OPEN"))}),$(this).stop(!0,!0).toggleClass("close")}),$(window).bind("resize load",function(e){C()}),C(),$(window).bind("resize load",function(e){C()}),C();$(".gallery").append('<div class="lightbox"><a href="#" class="light_close">關閉</a><a href="#" class="light_prev">上一張</a><a href="#" class="light_next">下一張</a><img src="" alt=""><div class="galler_overlay"></div></div>'),$(".gallery .lightbox").hide(),$(".light_close").click(function(e){$(".gallery .lightbox").hide(),t.removeClass("noscroll"),$(".gallery .lightbox .caption").html(""),!1}),$(".gallery .lightbox .galler_overlay").click(function(e){$(".gallery .lightbox").hide(),t.removeClass("noscroll"),$(".gallery .lightbox .caption").html(""),!1});$(".gallery .lightbox img").attr("src");var _=0;$(".gallery a").click(function(e){e.preventDefault(),!0}),$(".gallery .thumbnail img").each(function(e){$(this).click(function(i){var n=$(this).attr("alt");t.addClass("noscroll"),$(".gallery .lightbox").append('<div class="caption">'+n+"<div>"),THUMB_PIC=$(this).attr("src"),$(".gallery .lightbox img").attr("src",THUMB_PIC),$(".gallery .lightbox").fadeIn(),$(".gallery .lightbox .galler_overlay").fadeIn(),_=e,i.preventDefault()})});var k,x,w=$(".gallery .thumbnail").length;function T(){_+1<w?_++:_=0,THUMB_PIC=$(".gallery .thumbnail img").eq(_).attr("src"),THUMB_H3=$(".gallery .thumbnail img").eq(_).attr("alt"),$(".gallery .lightbox .caption").html(THUMB_H3),$(".gallery .lightbox img").hide(),$(".gallery .lightbox img").fadeIn(),$(".gallery .lightbox img").attr("src",THUMB_PIC)}function H(){_+1>1?_--:_=w-1,THUMB_PIC=$(".gallery .thumbnail img").eq(_).attr("src"),THUMB_H3=$(".gallery .thumbnail img").eq(_).attr("alt"),$(".gallery .lightbox .caption").html(THUMB_H3),$(".gallery .lightbox img").hide(),$(".gallery .lightbox img").fadeIn(),$(".gallery .lightbox img").attr("src",THUMB_PIC)}function O(){$(".tabs").each(function(){var e,t=$(this),a=t.find(".tabItem"),l=a.children("a"),s=t.find(".tabContent"),o=t.width(),c=a.outerHeight(),r=t.find(".active").next().innerHeight(),h=a.length;function d(e){var l=$(this).parent(),s=t.offset().top,o=l.index()/2,h=s+c*o-b;a.removeClass("active"),l.addClass("active"),i<=n?(a.not(".active").next().slideUp(),l.next().slideDown(),$("html,body").stop(!0,!1).animate({scrollTop:h})):(a.not(".active").next().hide(),l.next().show(),r=l.next().innerHeight(),t.height(r+c)),e.preventDefault()}t.find(".active").next(".tabContent").show(),i>=n?(s.css("top",c),t.height(r+c),e=(o-0*(h-1))/h,a.width(e).css("margin-left",0),a.first().css("margin-left",0),a.last().css({position:"absolute",top:0,right:0}).width(e)):(t.css("height","auto"),a.width(o),a.css("margin-left",0).last().css("position","relative")),l.focus(d),l.click(d)})}$(".gallery .light_next").click(function(e){T(),e.preventDefault()}),$(".gallery .light_prev").click(function(e){H(),e.preventDefault()}),!0&&t.keydown(function(e){37==e.keyCode?H():39==e.keyCode?T():27==e.keyCode&&($(".gallery .lightbox").hide(),$("body").removeClass("noscroll"))}),e.resize(function(){clearTimeout(k),k=setTimeout(function(){i=e.outerWidth(),O()},50)}),$(".tabs>.tabItem:first-child>a").trigger("click"),O(),$(window).bind("scroll",function(){$(this).scrollTop()>200?$(".scrollToTop").fadeIn():$(".scrollToTop").fadeOut()}),$(".scrollToTop").click(function(e){$("html, body").animate({scrollTop:0},800,"easeOutExpo"),e.preventDefault()}),x=window.navigator.userAgent,/msie|Trident.*rv[ :]*11\./gi.test(x)&&$(".img-container").each(function(){var e=$(this).children("img").attr("src"),i=$(this);i.has(".none").addClass("ie-object-none"),i.has(".none").css("backgroundImage","url("+e+")"),i.has(".cover").addClass("ie-object-cover"),i.has(".cover").css("backgroundImage","url("+e+")"),i.has(".fill").addClass("ie-object-fill"),i.has(".fill").css("backgroundImage","url("+e+")"),i.has(".contain").addClass("ie-object-contain"),i.has(".contain").css("backgroundImage","url("+e+")")}),$("input,textarea").focus(function(){$(this).removeAttr("placeholder")}),$(document).on("change",".check_file",function(){for(var e=[],i=$(this).get(0).files.length,t=0;t<$(this).get(0).files.length;++t)e.push($(this).get(0).files[t].name);if(i>2){e.join(", ");$(this).closest(".upload_grp").find(".upload_file").attr("value",i+" files selected")}else $(this).closest(".upload_grp").find(".upload_file").attr("value",e)}),$(".cp_panel .share").children("ul").hide(),$(".cp_panel .share").prepend('<a href="#" class="shareButton"><img src="images/basic/icon_share.png" alt="share分享按鈕"></a>');var D=$(".shareButton");D.off().click(function(e){$(this).siblings("ul").stop(!0,!0).slideToggle(),e.preventDefault()}),D.keyup(function(e){$(this).siblings("ul").stop(!0,!0).slideDown()}),$(".cp_panel .share").find("li:last>a").focusout(function(e){$(this).parent().parent("ul").hide()}),$(document).on("touchend click",function(e){var i=$(".cp_panel .share");i.is(e.target)||0!==i.has(e.target).length||$(".share ul").hide()}),$(".font_size").find(".medium").addClass("active"),$(".font_size").find(".small").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("large_size").addClass("small_size"),$(this).addClass("active"),e.preventDefault()}),$(".font_size").find(".medium").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("large_size small_size"),$(this).addClass("active"),e.preventDefault()}),$(".font_size").find(".large").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("small_size").addClass("large_size"),$(this).addClass("active"),e.preventDefault()}),$(".category").find("a").off().click(function(e){$(this).parent("li").siblings().find("a").removeClass("active"),$(this).addClass("active")}),$(document).on("keydown",function(e){e.altKey&&83==e.keyCode&&($("html, body").animate({scrollTop:0},200,"easeOutExpo"),$(".search").find('input[type="text"]').focus()),e.altKey&&85==e.keyCode&&($("html, body").animate({scrollTop:0},200,"easeOutExpo"),$("header").find(".accesskey").focus()),e.altKey&&67==e.keyCode&&($("html, body").stop(!0,!0).animate({scrollTop:$(".main").find(".accesskey").offset().top},800,"easeOutExpo"),$(".main").find(".accesskey").focus()),e.altKey&&66==e.keyCode&&($("html, body").stop(!0,!0).animate({scrollTop:$("footer").find(".accesskey").offset().top},800,"easeOutExpo"),$("footer").find(".accesskey").focus())}),$("a.goCenter").keydown(function(e){13==e.which&&($("#aC").focus(),$("html, body").stop(!0,!0).animate({scrollTop:$(".main").find(".accesskey").offset().top},800,"easeOutExpo"))}),$(".language").find("ul").hide();var I=$(".language").children("a");I.off().click(function(e){$(this).next("ul").stop(!0,!0).slideToggle(),e.preventDefault()}),I.keyup(function(){$(this).next("ul").stop(!0,!0).slideDown()}),$(".language").find("ul li:last>a").focusout(function(){$(".language").find("ul").hide()}),$(document).on("touchend click",function(e){var i=e.target;$(i).is(".language a")||$(".language").find("ul").hide()})});